name: Naver News Crawler

on:
  schedule:
    # í•œêµ­ ì‹œê°„(KST) ì˜¤ì „ 8ì‹œ 50ë¶„ ì‹¤í–‰ (UTC 23:50)
    - cron: '50 23 * * *'
  workflow_dispatch:      # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼ ìƒì„±

jobs:
  build:
    runs-on: ubuntu-latest
    
    # [ìœ ì§€] ê¹ƒí—ˆë¸Œ ì„œë²„ì— íŒŒì¼ ì“°ê¸° ê¶Œí•œ ë¶€ì—¬
    permissions:
      contents: write

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run Crawler
        # [ìœ ì§€] GitHub Secretsì˜ API í‚¤ í™˜ê²½ ë³€ìˆ˜ ì—°ê²°
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python main.py

      - name: Commit and Push
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
          # [ìˆ˜ì •] ì›¹ì‚¬ì´íŠ¸ìš© index.html íŒŒì¼ì„ ì¶”ê°€í•˜ì—¬ ì»¤ë°‹ ë²”ìœ„ì— í¬í•¨í•©ë‹ˆë‹¤.
          git add naver_today_news.csv AI_Daily_Report.md index.html
          
          git commit -m "ğŸ¤– ìë™ AI ë‰´ìŠ¤ ë° ë™í–¥ ë¦¬í¬íŠ¸ ì—…ë°ì´íŠ¸" || echo "ë³€ê²½ì‚¬í•­ ì—†ìŒ"
          git push
